<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>marble.html</title>
    <script type="text/javascript"
            src = "simpleGame.js"></script>
    <script type="text/javascript">
    var game;
    var ball;
    var goal;
    var accel;

    Ball = function(){
        tBall = new Sprite(game, "img/redBall.png", 25, 25);
        tBall.setSpeed(0);
        tBall.setPosition(100, 100);
        
        tBall.reset = function(){
            newX = Math.random() * this.cWidth;
            newY = Math.random() * this.cHeight;
            
            this.setPosition(newX, newY);            
        }; // end reset
    
        tBall.checkKeys = function(){
            //temporary function for testing
            //wow such directions
            if (keysDown[K_UP]){
                this.changeXby(-5);
            }
            
            if (keysDown[K_DOWN]){
                this.changeXby(5);
            }
            
            if (keysDown[K_LEFT]){
                this.changeYby(-5);
            }
            
            if (keysDown[K_RIGHT]){
                this.changeYby(5);
            }
        }; // end checkKeys
        
        tBall.checkAccel = function(){
            //use the accelerometer to get input
            newDX = accel.getAY();
            newDY = accel.getAX();
            
            newDX *= -5;
            newDY *= -5;
            
            ball.setDX(newDX);
            ball.setDY(newDY);
        };// end checkAccel

        tBall.checkBounds = function(){
            //ensure the ball doesn't wrap to opposite side of screen
            //when traveling past edge boundaries
            if (this.y > 1190) {
                this.y = 1190;
            }
            if (this.y < 10) {
                this.y = 10;
            }
            if (this.x < 10) {
                this.x = 10;
            }
            if (this.x > 940) {
                this.x = 940;
            }
        };
        
        return tBall;
    }; // end ball
    
    Goal = function(){
        tGoal = new Sprite(game, "img/goal.png", 50, 50);
        tGoal.setSpeed(0);
        
        tGoal.reset = function(){
            newX = Math.random() * this.cWidth;
            newY = Math.random() * this.cHeight;
            
            this.setPosition(newX, newY);
        }; // end reset
        
        tGoal.reset();
        
        return tGoal;
    }; // end goal
    
    function checkGoal(){
        if (ball.collidesWith(goal)){
            goal.reset();
        } // end if
    } // end check

    Wall1 = function(){
        tWall1 = new Sprite(game, "img/brick.png", 40, 200);
        tWall1.setSpeed(0);

        tWall1.reset = function(){ 
            this.setPosition(700, 1100);
        }; // end reset

        tWall1.reset();

        return tWall1;
    }; // end wall 1

    Wall2 = function(){
        tWall2 = new Sprite(game, "img/brick.png", 800, 40);
        tWall2.setSpeed(0);

        tWall2.reset = function(){
            this.setPosition(400, 200);
        }; // end reset

        tWall2.reset();

        return tWall2;
    }; // end wall 2

    Wall3 = function(){
        tWall3 = new Sprite(game, "img/brick.png", 40, 400);
        tWall3.setSpeed(0);

        tWall3.reset = function(){
            this.setPosition(150, 500);
        }; // end reset

        tWall3.reset();

        return tWall3;
    }; // end wall 3

    Wall4 = function(){
        tWall4 = new Sprite(game, "img/brick.png", 500, 40);
        tWall4.setSpeed(0);

        tWall4.reset = function(){
            this.setPosition(700, 750);
        }; // end reset

        tWall4.reset();

        return tWall4;
    };

    Wall5 = function(){
        tWall5 = new Sprite(game, "img/brick.png", 40, 200);
        tWall5.setSpeed(0);

        tWall5.reset = function(){
            this.setPosition(470, 870);
        }; // end reset

        tWall5.reset();

        return tWall5;
    };

    Wall6 = function(){
        tWall6 = new Sprite(game, "img/brick.png", 240, 40);
        tWall6.setSpeed(0);

        tWall6.reset = function(){
            this.setPosition(370, 990);
        }; // end reset

        tWall6.reset();

        return tWall6;
    };

    function init(){
        game = new Scene();
        game.setSize(950, 1200);
        ball = new Ball();
        goal = new Goal();
        // wall1 = new Wall1();
        // wall2 = new Wall2();
        // wall3 = new Wall3();
        // wall4 = new Wall4();
        // wall5 = new Wall5();
        // wall6 = new Wall6();
        console = document.getElementById("blockCounter");
        // init rect ...
        rect = new Sprite(game, "img/brick.png", 240, 80);
        rect.setPosition(475, 600);
        rect.setSpeed(0);
        
        accel = new Accel();
        
        game.start();
    } // end init
    
    function update(){
        game.clear();
        //get input from accelerometer or keyboard
        if (game.touchable){
            ball.checkAccel();            
        } else {
            ball.checkKeys();            
        }
        
        checkGoal();
        goal.update();
        rect.update();
        // wall1.update();
        // wall2.update();
        // wall3.update();
        // wall4.update();
        // wall5.update();
        // wall6.update();
        
        ball.forceOutOfRect(rect);
        ball.update();
        // ball.update();
        console.innerHTML = "ball.x" + ball.x + "," + "ball.y" + "ball.y";
    } // end update
    
    </script>
</head>
<body onload = "init()">
    <div id = "blockCounter">
        Blocks: 10
    </div>
</body>
</html>
